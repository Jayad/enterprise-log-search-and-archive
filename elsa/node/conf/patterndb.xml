<patterndb version='3' pub_date='2009-11-04'>
	<ruleset name="FWSM" id='2'>
		<pattern>%FWSM</pattern>
		<rules>
			<rule provider="ELSA" class='2' id='2'>
				<patterns>
					<pattern>Deny@QSTRING:i0: @src@QSTRING:s0: :@@IPv4:i1:@/@NUMBER:i2:@ dst@QSTRING:s1: :@@IPv4:i3:@/@NUMBER:i4:@ by access-group @QSTRING:s2:"@</pattern>
					<pattern>Deny @ESTRING:: @@ESTRING:i0: @src @ESTRING:s0::@@IPv4:i1:@/@NUMBER:i2:@ dst @ESTRING:s1::@@IPv4:i3:@/@NUMBER:i4:@</pattern>
					<pattern>Shunned packet: @IPv4:i1:@ ==> @IPv4:i3:@ on interface @ANYSTRING:s0:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="%FWSM-3-106010">Deny inbound tcp src OUTSIDE:2.116.180.66/3116 dst INSIDE:10.0.0.0/445</test_message>
						<test_values>
							<test_value name="i0">tcp</test_value>
							<test_value name="s0">OUTSIDE</test_value>
							<test_value name="i1">2.116.180.66</test_value>
							<test_value name="i2">3116</test_value>
							<test_value name="s1">INSIDE</test_value>
							<test_value name="i3">10.0.0.0</test_value>
							<test_value name="i4">445</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
			<rule provider="ELSA" class='3' id='3'>
				<patterns>
					<pattern>Teardown@QSTRING:i0: @connection @NUMBER::@ for@QSTRING:s0: :@@IPv4:i1:@/@NUMBER:i2:@ to@QSTRING:s1: :@@IPv4:i3:@/@NUMBER:i4:@ duration@QSTRING:s2: @bytes @NUMBER:i5:@</pattern>
				</patterns>
			</rule>
			<rule provider="ELSA" class='7' id='7'>
				<patterns>
					<pattern>@IPv4:i0:@ Accessed URL @IPv4:i1:@:@ESTRING::/@/@ESTRING:s1:/@@ANYSTRING:s2:@</pattern>
					<pattern>@IPv4:i0:@ Accessed URL @IPv4:i1:@:@ESTRING::/@/@ESTRING:s1:/@</pattern>
					<pattern>Access denied URL @ESTRING::/@/@ESTRING:s1:/@@ESTRING:s2: @SRC @IPv4:i0:@ DEST @IPv4:i1:@ on interface </pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="%FWSM-5-304001">192.168.1.1 Accessed URL 10.0.0.0:http://www.example.com/wp-content/plugins/wp-spamfree/img/wpsf-img.php</test_message>
						<test_values>
							<test_value name="i0">192.168.1.1</test_value>
							<test_value name="i1">10.0.0.0</test_value>
							<test_value name="s1">www.example.com</test_value>
							<test_value name="s2">wp-content/plugins/wp-spamfree/img/wpsf-img.php</test_value>
						</test_values>
					</example>
					<example>
						<test_message program="FWSM-5-304002">Access denied URL http://www.example.com/feedout/content SRC 192.168.1.1 DEST 72.246.55.49 on interface inside</test_message>
							<test_values>
								<test_value name="s1">www.example.com</test_value>
								<test_value name="s2">feedout/content</test_value>
								<test_value name="i0">192.168.1.1</test_value>
								<test_value name="i1">72.246.55.49</test_value>
							</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="ASA" id='2_ASA'>
		<pattern>%ASA</pattern>
		<rules>
			<rule provider="ELSA" class='2' id='2'>
				<patterns>
					<pattern>Deny@QSTRING:i0: @src@QSTRING:s0: :@@IPv4:i1:@/@NUMBER:i2:@ dst@QSTRING:s1: :@@IPv4:i3:@/@NUMBER:i4:@ by access-group @QSTRING:s2:"@</pattern>
					<pattern>Deny @ESTRING:i0: @src @ESTRING:s0::@@IPv4:i1:@/@NUMBER:i2:@ dst @ESTRING:s1::@@IPv4:i3:@/@NUMBER:i4:@ by access-group @ESTRING:s2: @</pattern>
					<pattern>Deny @ESTRING:i0: @src @ESTRING:s0::@@IPv4:i1:@/@NUMBER:i2:@ dst @ESTRING:s1::@@ESTRING::/@@NUMBER:i4:@ by access-group @ESTRING:s2: @</pattern>
					<pattern>Deny @ESTRING:i0: @src @ESTRING:s0::@@ESTRING::/@@NUMBER:i2:@ dst @ESTRING:s1::@@IPv4:i3:@/@NUMBER:i4:@ by access-group @ESTRING:s2: @</pattern>
					<pattern>Deny @ESTRING:i0: @src @ESTRING:s0::@@IPv4:i1:@ dst @ESTRING:s1::@@IPv4:i3:@ (type @NUMBER::@, code @NUMBER::@) by access-group @ESTRING:s2: @</pattern>
					<pattern>Shunned packet: @IPv4:i1:@ ==> @IPv4:i3:@ on interface @ANYSTRING:s0:@</pattern>
				</patterns>
			</rule>
			<rule provider="ELSA" class='3' id='3'>
				<patterns>
					<pattern>Teardown@QSTRING:i0: @connection @NUMBER::@ for@QSTRING:s0: :@@IPv4:i1:@/@NUMBER:i2:@ to@QSTRING:s1: :@@IPv4:i3:@/@NUMBER:i4:@ duration@QSTRING:s2: @bytes @NUMBER:i5:@</pattern>
				</patterns>
			</rule>
			<rule provider="ELSA" class='7' id='7'>
				<patterns>
					<pattern>@IPv4:i0:@ Accessed URL @IPv4:i1:@:@ESTRING::/@/@ESTRING:s1:/@@ANYSTRING:s2:@</pattern>
					<pattern>@IPv4:i0:@ Accessed URL @IPv4:i1:@:@ESTRING::/@/@ESTRING:s1:/@</pattern>
					<pattern>Access denied URL @ESTRING::/@/@ESTRING:s1:/@@ESTRING:s2: @SRC @IPv4:i0:@ DEST @IPv4:i1:@ on interface </pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="%ASA-5-304001">192.168.1.1 Accessed URL 10.0.0.0:http://www.example.com/wp-content/plugins/wp-spamfree/img/wpsf-img.php</test_message>
						<test_values>
							<test_value name="i0">192.168.1.1</test_value>
							<test_value name="i1">10.0.0.0</test_value>
							<test_value name="s1">www.example.com</test_value>
							<test_value name="s2">wp-content/plugins/wp-spamfree/img/wpsf-img.php</test_value>
						</test_values>
					</example>
					<example>
						<test_message program="ASA-5-304002">Access denied URL http://www.example.com/feedout/content SRC 192.168.1.1 DEST 72.246.55.49 on interface inside</test_message>
							<test_values>
								<test_value name="s1">www.example.com</test_value>
								<test_value name="s2">feedout/content</test_value>
								<test_value name="i0">192.168.1.1</test_value>
								<test_value name="i1">72.246.55.49</test_value>
							</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="PIX" id='2_PIX'>
		<pattern>%PIX</pattern>
		<rules>
			<rule provider="ELSA" class='2' id='2'>
				<patterns>
					<pattern>Deny@QSTRING:i0: @src@QSTRING:s0: :@@IPv4:i1:@/@NUMBER:i2:@ dst@QSTRING:s1: :@@IPv4:i3:@/@NUMBER:i4:@ by access-group @QSTRING:s2:"@</pattern>
					<pattern>Shunned packet: @IPv4:i1:@ ==> @IPv4:i3:@ on interface @ANYSTRING:s0:@</pattern>
				</patterns>
			</rule>
			<rule provider="ELSA" class='3' id='3'>
				<patterns>
					<pattern>Teardown@QSTRING:i0: @connection @NUMBER::@ for@QSTRING:s0: :@@IPv4:i1:@/@NUMBER:i2:@ to@QSTRING:s1: :@@IPv4:i3:@/@NUMBER:i4:@ duration@QSTRING:s2: @bytes @NUMBER:i5:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="%PIX-6-302014">Teardown TCP connection 2050472353 for outside:10.65.200.34/1252 to inside:10.0.0.0/135 duration 0:00:00 bytes 1476 TCP FINs</test_message>
						<test_values>
							<test_value name="i0">TCP</test_value>
							<test_value name="s0">outside</test_value>
							<test_value name="i1">10.65.200.34</test_value>
							<test_value name="i2">1252</test_value>
							<test_value name="s1">inside</test_value>
							<test_value name="i3">10.0.0.0</test_value>
							<test_value name="i4">135</test_value>
							<test_value name="s2">0:00:00</test_value>
							<test_value name="i5">1476</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="Cisco IOS XE Translations" id='3'>
		<pattern>%IOSXE-6-PLATFORM</pattern>
		<rules>
			<rule provider="ELSA" class='3' id='3'>
				<patterns>
					<pattern>@ESTRING::%NAT-6-LOG_TRANSLATION: Created Translation @@ESTRING:i0: @@IPv4:i1:@:@NUMBER:i2:@ @IPv4::@:@NUMBER::@ @IPv4::@:@NUMBER::@ @IPv4:i3:@:@NUMBER:i4:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="%IOSXE-6-PLATFORM">F0: cpp_cp: QFP:0.0 Thread:031 TS:00000428205839105179 %NAT-6-LOG_TRANSLATION: Created Translation TCP 1.1.1.1:4227 1.1.1.1:1043 2.2.2.2:80 2.2.2.2:80 0</test_message>
						<test_values>
							<test_value name="i0">TCP</test_value>
							<test_value name="i1">1.1.1.1</test_value>
							<test_value name="i2">1043</test_value>
							<test_value name="i3">2.2.2.2</test_value>
							<test_value name="i4">80</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="Cisco IOS XE Denies" id='2'>
		<pattern>%SEC-6-IPACCESSLOGS</pattern>
		<rules>
			<rule provider="ELSA" class='2' id='2'>
				<patterns>
					<pattern>list @ESTRING::denied @@IPv4:i3:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="%SEC-6-IPACCESSLOGS">list REMOTE-MGMT denied 1.1.1.1 1 packet [0x7EAD30FB]</test_message>
						<test_values>
							<test_value name="i3">1.1.1.1</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="Cisco IOS XE Denies" id='2'>
		<pattern>%FMANFP-6-IPACCESSLOGP</pattern>
		<rules>
			<rule provider="ELSA" class='2' id='2'>
				<patterns>
					<pattern>F@ESTRING::denied @@ESTRING:i0: @@IPv4:i1:@(@NUMBER:i2:@) -&gt; @IPv4:i3:@(@NUMBER:i4:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="%FMANFP-6-IPACCESSLOGP">F0: fman_fp_image: list IPV4-INTERNET-OUTBOUND denied udp 1.1.1.1(49610) -&gt; 2.2.2.2(53), 1 packet</test_message>
						<test_values>
							<test_value name="i0">udp</test_value>
							<test_value name="i1">1.1.1.1</test_value>
							<test_value name="i2">49610</test_value>
							<test_value name="i3">2.2.2.2</test_value>
							<test_value name="i4">53</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="Cisco IOS XE Denies" id='2'>
		<pattern>%FMANFP-6-IPV6ACCESSLOGP</pattern>
		<rules>
			<rule provider="ELSA" class='2' id='2'>
				<patterns>
					<pattern>F@ESTRING::denied @@ESTRING:i0: @@ESTRING:s0:(@@NUMBER:i2:@) -&gt; @ESTRING:s1:(@@NUMBER:i4:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="%FMANFP-6-IPV6ACCESSLOGP">F0: fman_fp_image: list IPV6-INTERNET-INBOUND denied udp ffe:4e0::(38346) -&gt; ffe:4e0::(40322), 1 packet</test_message>
						<test_values>
							<test_value name="i0">udp</test_value>
							<test_value name="s0">ffe:4e0::</test_value>
							<test_value name="i2">38346</test_value>
							<test_value name="s1">ffe:4e0::</test_value>
							<test_value name="i4">40322</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="Windows_Snare" id='4'>
		<pattern>MSWinEventLog</pattern>
		<pattern>Application</pattern>
		<pattern>Security</pattern>
		<pattern>System</pattern>
		<rules>
			<rule provider="ELSA" class='4' id='4'>
				<patterns>
					<pattern>@STRING::@ @NUMBER::@ @NUMBER::@:@NUMBER::@:@NUMBER::@ @NUMBER::@	@ESTRING:i0:	@@ESTRING:s0:	@@ESTRING:s1:	@@ESTRING:s2:	@@ESTRING:s3:	@@ESTRING:s4:	@@ESTRING:s5:	@@ESTRING::	@@ESTRING::	@</pattern>
					<pattern>@STRING::@ @NUMBER::@ @NUMBER::@:@NUMBER::@:@NUMBER::@ @NUMBER::@|@ESTRING:i0:|@@ESTRING:s0:|@@ESTRING::|@@ESTRING::|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING:s5:|@|Logon Failure:@ESTRING::	@Reason:		@ESTRING:s2:	@User Name:	@ESTRING:s1: @</pattern>
					<pattern>@STRING::@ @NUMBER::@ @NUMBER::@:@NUMBER::@:@NUMBER::@ @NUMBER::@|@ESTRING:i0:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING::|@@ESTRING::|@</pattern>
					<pattern>@STRING::@ @NUMBER::@ @NUMBER::@:@NUMBER::@:@NUMBER::@ @NUMBER::@|@ESTRING:i0:|@@ESTRING:s0:|@@ESTRING:s1:|@@ANYSTRING@</pattern>
				</patterns>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="Windows_evtsys" id='4'>
		<pattern>Application</pattern>
		<pattern>Security</pattern>
		<pattern>System</pattern>
		<rules>
			<rule provider="ELSA" class='4' id='4'>
				<patterns>
					<pattern>@NUMBER:i0:@: A network share object was accessed. Subject: Security ID: @ESTRING:: @Account Name: @ESTRING:s1: Account Domain@: @ESTRING:s2: Logon ID@: @ESTRING:: @Network Information: Object Type: File Source Address: @IPv4:i1:@ Source Port: @NUMBER::@ Share Information: Share Name: @ESTRING:s3: Share Path:@ @ESTRING:s4: Access Request Information:@ </pattern>
					<pattern>@NUMBER:i0:@: A network share object was accessed. Subject: Security ID: @ESTRING:: @Account Name: @ESTRING:s1: Account Domain@: @ESTRING:s2: Logon ID@: @ESTRING:: @Network Information: Object Type: File Source Address: @IPv4:i1:@ Source Port: @NUMBER::@ Share Information: Share Name: @ESTRING:s3: Share Path:@</pattern>
					<pattern>@NUMBER:i0:@: A network share object was checked to see whether client can be granted desired access. Subject: Security ID: @ESTRING:: @Account Name: @ESTRING:s1: @Account Domain: @ESTRING:s2: @Logon ID: @ESTRING:: @Network Information: Object Type: File Source Address: @ESTRING:i1: @Source Port: @NUMBER::@ Share Information: Share Name: @ESTRING:s3: @Share Path: @ESTRING:s4: @Relative Target Name: @ESTRING:s5: @Access</pattern>
					<pattern>@NUMBER:i0:@: @ESTRING::.@ Client IP address: @IPv4:s0::@</pattern>
					<pattern>@NUMBER:i0:@: @ESTRING:s0::@</pattern>
					<pattern>@NUMBER:i0:@: @ANYSTRING::@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="Service_Control_Manager">7035: NT AUTHORITYSYSTEM: The COH_Mon service was successfully sent a start control.</test_message>
						<test_values>
							<test_value name="i0">7035</test_value>
							<test_value name="s0">NT AUTHORITYSYSTEM</test_value>
						</test_values>
					</example>
					<example>
						<test_message program="SceCli">1202: Security policies were propagated with warning. 0x4b8 : An extended error has occurred. For best results in resolving this event, log on with a non-administrative account and search http://support.microsoft.com for "Troubleshooting Event 1202's".</test_message>
						<test_value name="i0">1202</test_value>
						<test_value name="s0">Security policies were propagated with warning. 0x4b8 </test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="Windows_evtsys" id='4'>
		<!-- no program pattern -->
		<rules>
			<rule provider="ELSA" class='4' id='4'>
				<patterns>
					<pattern>@NUMBER:i0:@: A network share object was accessed. Subject: Security ID: @ESTRING:: @Account Name: @ESTRING:s1: Account Domain@: @ESTRING:s2: Logon ID@: @ESTRING:: @Network Information: Object Type: File Source Address: @IPv4:i1:@ Source Port: @NUMBER::@ Share Information: Share Name: @ESTRING:s3: Share Path:@ @ESTRING:s4: Access Request Information:@ </pattern>
					<pattern>@NUMBER:i0:@: A network share object was accessed. Subject: Security ID: @ESTRING:: @Account Name: @ESTRING:s1: Account Domain@: @ESTRING:s2: Logon ID@: @ESTRING:: @Network Information: Object Type: File Source Address: @IPv4:i1:@ Source Port: @NUMBER::@ Share Information: Share Name: @ESTRING:s3: Share Path:@</pattern>
					<pattern>@NUMBER:i0:@: A network share object was checked to see whether client can be granted desired access. Subject: Security ID: @ESTRING:: @Account Name: @ESTRING:s1: @Account Domain: @ESTRING:s2: @Logon ID: @ESTRING:: @Network Information: Object Type: File Source Address: @ESTRING:i1: @Source Port: @NUMBER::@ Share Information: Share Name: @ESTRING:s3: @Share Path: @ESTRING:s4: @Relative Target Name: @ESTRING:s5: @Access</pattern>
					<pattern>@NUMBER:i0:@: @ESTRING::.@ Client IP address: @IPv4:s0::@</pattern>
					<pattern>@NUMBER:i0:@: @ESTRING:s0::@</pattern>
					<pattern>@NUMBER:i0:@: @ANYSTRING::@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="Service_Control_Manager">7035: NT AUTHORITYSYSTEM: The COH_Mon service was successfully sent a start control.</test_message>
						<test_values>
							<test_value name="i0">7035</test_value>
							<test_value name="s0">NT AUTHORITYSYSTEM</test_value>
						</test_values>
					</example>
					<example>
						<test_message program="SceCli">1202: Security policies were propagated with warning. 0x4b8 : An extended error has occurred. For best results in resolving this event, log on with a non-administrative account and search http://support.microsoft.com for "Troubleshooting Event 1202's".</test_message>
						<test_value name="i0">1202</test_value>
						<test_value name="s0">Security policies were propagated with warning. 0x4b8 </test_value>
					</example>
					<example>
						<test_message program="security-auditing">5140: A network share object was accessed. Subject: Security ID: S-1-5-18 Account Name: MYUSER Account Domain: MYDOMAIN Logon ID: 0x3e7 Network Information: Object Type: File Source Address: 192.168.148.5 Source Port: 49206 Share Information: Share Name: \\*\ADMIN$ Share Path: \??\C:\Windows Access Request Information: Access Mask: 0x1 Accesses: ReadData (or ListDirectory)</test_message>
						<test_value name="i0">5140</test_value>
						<test_value name="s1">MYUSER</test_value>
						<test_value name="s2">MYDOMAIN</test_value>
						<test_value name="i1">192.168.148.5</test_value>
						<test_value name="s3">\\*\ADMIN$</test_value>
						<test_value name="s4">\??\C:\Windows</test_value>
					</example>
					<example>
						<test_message program="security-auditing">5140: A network share object was accessed. Subject: Security ID: S-1-5-7 Account Name: ANONYMOUS LOGON Account Domain: NT AUTHORITY Logon ID: 0x1e05bb9b Network Information: Object Type: File Source Address: 192.168.148.5 Source Port: 65518 Share Information: Share Name: \\\\*\\IPC$ Share Path: Access Request Information: Access Mask: 0x1 Accesses: ReadData (or ListDirectory)</test_message>
						<test_value name="i0">5140</test_value>
						<test_value name="s1">ANONYMOUS LOGON</test_value>
						<test_value name="s2">NT AUTHORITY</test_value>
						<test_value name="i1">192.168.148.5</test_value>
						<test_value name="s3">\\\\*\\IPC$</test_value>
					</example>
					<example>
						<test_message program="security-auditing">5145: A network share object was checked to see whether client can be granted desired access. Subject: Security ID: S-1-5-21-518783779-1162290680-929701000-2097 Account Name: MYUSER Account Domain: MYDOMAIN Logon ID: 0x19789189 Network Information: Object Type: File Source Address: 192.168.148.5 Source Port: 4235 Share Information: Share Name: \\*\SHARE_NAME Share Path: \??\C:\SHARE_PATH Relative Target Name: MYFILE Access Request Information: Access Mask: 0x80 Accesses: ReadAttributes Access Check Results: ReadAttributes: Granted by D:(A;;FA;;;WD)</test_message>
						<test_value name="i0">5145</test_value>
						<test_value name="s1">MYUSER</test_value>
						<test_value name="s2">MYDOMAIN</test_value>
						<test_value name="i1">192.168.148.5</test_value>
						<test_value name="s3">\\*\SHARE_NAME</test_value>
						<test_value name="s4">\??\C:\SHARE_PATH</test_value>
						<test_value name="s5">MYFILE</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="Windows_dhcp" id='4_dhcp'>
		<pattern>GenericLog</pattern>
		<rules>
			<rule provider="ELSA" class='4' id='4'>
				<patterns>
					<pattern>@NUMBER::@,@ANYSTRING::@</pattern>
					<values>
						<value name="i0">0</value>
						<value name="s0">dhcplog</value>
						<value name="PROGRAM">dhcplog</value>
					</values>
					<!--<pattern>@NUMBER:i0:@,@ESTRING:s0:,@@ESTRING:s1:,@@ESTRING:s2:,@@ESTRING:s3:,@@ESTRING:s4:,@</pattern>
					<pattern>@NUMBER:i0:@,@ESTRING:s0:,@@ESTRING:s1:,@@ESTRING:s2:,@@ESTRING:s3:,@@ESTRING:s4:,@@ESTRING:s5:,@</pattern>-->
				</patterns>
				<examples>
					<example>
						<test_message program="GenericLog">30,11/16/10,12:25:04,DNS Update Request,x.x.x.x,hostname,,</test_message>
						<test_value name="i0">0</test_value>
						<test_value name="s0">dhcplog</test_value>
						<test_value name="PROGRAM">dhcplog</test_value>
					</example>
					<example>
						<test_message program="GenericLog">11,11/16/10,12:25:04,Renew,x.x.x.x,hostname,macaddr,</test_message>
						<test_value name="i0">0</test_value>
						<test_value name="s0">dhcplog</test_value>
						<test_value name="PROGRAM">dhcplog</test_value>
					</example>
				</examples>
				<tags>
					<tag>4</tag>
				</tags>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="Adiscon" id="4_adiscon">
		<rule provider="ELSA" class='4' id='4'>
			<pattern>@ESTRING::Event ID@: @NUMBER:i0:@ &lt;Data Name='TargetUserName'&gt;@ESTRING:s0:&lt;@</pattern>
			<pattern>@ESTRING::Event ID@: @NUMBER:i0:@</pattern>
			<examples>
				<example>
					<test_message program="">Mar  9 22:35:10 IU-MSSG-ADSDC01.domain Event ID: 5157 &lt;Data Name='ProcessID'&gt;180&lt;/Data&gt;&lt;Data Name='Application'&gt;\device\harddiskvolume2\windows\system32\svchost.exe&lt;/Data&gt;&lt;Data Name='Direction'&gt;%14592&lt;/Data&gt;&lt;Data Name='SourceAddress'&gt;10.68.239.128&lt;/Data&gt;&lt;Data Name='SourcePort'&gt;500&lt;/Data&gt;&lt;Data Name='DestAddress'&gt;10.166.175.52&lt;/Data&gt;&lt;Data Name='DestPort'&gt;500&lt;/Data&gt;&lt;Data Name='Protocol'&gt;17&lt;/Data&gt;&lt;Data Name='FilterRTID'&gt;73486&lt;/Data&gt;&lt;Data Name='LayerName'&gt;%14610&lt;/Data&gt;&lt;Data Name='LayerRTID'&gt;44&lt;/Data&gt;&lt;Data Name='RemoteUserID'&gt;S-1-0-0&lt;/Data&gt;&lt;Data Name='RemoteMachineID'&gt;S-1-0-0&lt;/Data&gt;</test_message>
					<test_value name="i0">5157</test_value>
				</example>
				<example>
					<test_message program="">Mar  9 22:35:10 IU-MSSG-ADSDC04.domain Event ID: 4769 &lt;Data Name='TargetUserName'&gt;user@domain&lt;/Data&gt;&lt;Data Name='TargetDomainName'&gt;domain&lt;/Data&gt;&lt;Data Name='ServiceName'&gt;IU-MSSG-ADSDC04$&lt;/Data&gt;&lt;Data Name='ServiceSid'&gt;S-1-5-21-1085031214-1292428093-527237240-496356&lt;/Data&gt;&lt;Data Name='TicketOptions'&gt;0x40810000&lt;/Data&gt;&lt;Data Name='TicketEncryptionType'&gt;0x12&lt;/Data&gt;&lt;Data Name='IpAddress'&gt;::ffff:10.160.118.87&lt;/Data&gt;&lt;Data Name='IpPort'&gt;54144&lt;/Data&gt;&lt;Data Name='Status'&gt;0x0&lt;/Data&gt;&lt;Data Name='LogonGuid'&gt;{CD66EF59-4404-F056-C1CC-5E12BE6B978E}&lt;/Data&gt;&lt;Data Name='TransmittedServices'&gt;-&lt;/Data&gt;</test_message>
					<test_value name="i0">4769</test_value>
					<test_value name="s0">user@domain</test_value>
				</example>
					
			</examples>
		</rule>
	</ruleset>
	<ruleset name="url" id='7'>
		<pattern>url</pattern>
		<rules>
			<rule provider="ELSA" class='7' id='7'>
				<patterns>
					<!--<pattern>@IPv4:i0:@,@IPv4:i1:@,@ESTRING:s0:,@@ESTRING:s5:,@@ESTRING:s2:,@@ESTRING:s3:,@@STRING:s4: :/;,.-()@</pattern>-->
					<!--<pattern>@IPv4:i0:@,@IPv4:i1:@,@ESTRING:s0:,@@ESTRING:s1:,@@ESTRING:s2:,@@ESTRING:s3:,@@ESTRING:s4:|@@STRING:s5:,.-@</pattern>-->
					<!-- httpry_logger.pl -->
					<pattern>@IPv4:i0:@,@IPv4:i1:@,@ESTRING:s0:,@@ESTRING:s1:,@@ESTRING:s2:,@@ESTRING:s3:,@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING:i2:|@@NUMBER:i3:@|@NUMBER:i4:@</pattern>
					<pattern>@IPv4:i0:@,@IPv4:i1:@,@ESTRING:s0:,@@ESTRING:s1:,@@ESTRING:s2:,@@ESTRING:s3:,@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING:i2:|@|@NUMBER:i4:@</pattern>
					<pattern>@IPv4:i0:@,@IPv4:i1:@,@ESTRING:s0:,@@ESTRING:s1:,@@ESTRING:s2:,@@ESTRING:s3:,@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING:i2:|@</pattern>
					<pattern>@IPv4:i0:@|@IPv4:i1:@|@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i4:|@@NUMBER:i5@</pattern>
					<pattern>@IPv4:i0:@|@IPv4:i1:@|@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING:i2:|@@NUMBER:i3:@|@NUMBER:i4:@</pattern>
					<pattern>@IPv4:i0:@|@IPv4:i1:@|@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING:i2:|@|@NUMBER:i4:@</pattern>
					<pattern>@IPv4:i0:@|@IPv4:i1:@|@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING:i2:|@@NUMBER:i3:@|</pattern>
					<pattern>@IPv4:i0:@|@IPv4:i1:@|@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING:i2:|@</pattern>
					<!-- suricata -->
					<pattern>@ESTRING:: @@ESTRING:s1: [**] @@ESTRING:s2: [**] @@ESTRING:s4: [**] @@IPv4:i0:@:@NUMBER:i1:@ -> @IPv4:i2:@:@NUMBER:i3:@</pattern>
					<!-- suricata extended -->
					<pattern>@ESTRING:: @@ESTRING:s1: [**] @@ESTRING:s2: [**] @@ESTRING:s4: [**] @@ESTRING:s3: [**] @@ESTRING:s0: [**] @@ESTRING:: [**] @@ESTRING:i2: [**] @@NUMBER:i3:@ bytes [**] @IPv4:i0:@:@NUMBER:i4:@ -> @IPv4:i1:@:@NUMBER:i5:@</pattern>
					<!--Common Log Format-->
					<pattern>@IPv4:i0:@ @ESTRING:: @@ESTRING:s5: @@ESTRING:: "@@ESTRING:s0: @@ESTRING:s2: @HTTP/1.@NUMBER::@" @NUMBER:i2:@ @NUMBER:i3:@ @QSTRING:s3:"@ @QSTRING:s4:"@</pattern>
					<!--%{HOST} + Common Log Format-->
					<pattern>@ESTRING:s1: @@IPv4:i0:@ @ESTRING:: @@ESTRING:s5: @@ESTRING:: "@@ESTRING:s0: @@ESTRING:s2: @HTTP/1.@NUMBER::@" @NUMBER:i2:@ @NUMBER:i3:@ @QSTRING:s3:"@ @QSTRING:s4:"@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="url">192.168.1.1,10.0.0.0,GET,ajax.googleapis.com,/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js,http://slickdeals.net/,Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)|,com,googleapis.com,ajax.googleapis.com|200|46142|8583</test_message>
						<test_values>
							<test_value name="i0">192.168.1.1</test_value>
							<test_value name="i1">10.0.0.0</test_value>
							<test_value name="s0">GET</test_value>
							<test_value name="s1">ajax.googleapis.com</test_value>
							<test_value name="s2">/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js</test_value>
							<test_value name="s3">http://slickdeals.net/</test_value>
							<test_value name="s4">Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)</test_value>
							<test_value name="s5">,com,googleapis.com,ajax.googleapis.com</test_value>
							<test_value name="i2">200</test_value>
							<test_value name="i3">46142</test_value>
							<test_value name="i4">8583</test_value>
						</test_values>
					</example>
					<example>
						<test_message program="url">192.168.1.1,10.0.0.0,GET,ajax.googleapis.com,/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js,http://slickdeals.net/,Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)|,com,googleapis.com,ajax.googleapis.com|200||8583</test_message>
						<test_values>
							<test_value name="i0">192.168.1.1</test_value>
							<test_value name="i1">10.0.0.0</test_value>
							<test_value name="s0">GET</test_value>
							<test_value name="s1">ajax.googleapis.com</test_value>
							<test_value name="s2">/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js</test_value>
							<test_value name="s3">http://slickdeals.net/</test_value>
							<test_value name="s4">Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)</test_value>
							<test_value name="s5">,com,googleapis.com,ajax.googleapis.com</test_value>
							<test_value name="i2">200</test_value>
							<test_value name="i3"></test_value>
							<test_value name="i4">8583</test_value>
						</test_values>
					</example>
					<example>
						<test_message program="url">192.168.1.1,10.0.0.0,GET,ajax.googleapis.com,/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js,http://slickdeals.net/,Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)|,com,googleapis.com,ajax.googleapis.com|200||</test_message>
						<test_values>
							<test_value name="i0">192.168.1.1</test_value>
							<test_value name="i1">10.0.0.0</test_value>
							<test_value name="s0">GET</test_value>
							<test_value name="s1">ajax.googleapis.com</test_value>
							<test_value name="s2">/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js</test_value>
							<test_value name="s3">http://slickdeals.net/</test_value>
							<test_value name="s4">Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)</test_value>
							<test_value name="s5">,com,googleapis.com,ajax.googleapis.com</test_value>
							<test_value name="i2">200</test_value>
							<test_value name="i3"></test_value>
							<test_value name="i4"></test_value>
						</test_values>
					</example>
					<example>
						<test_message program="url">127.0.0.1 - - [09/Dec/2012:23:20:27 -0600] "HEAD / HTTP/1.1" 200 334 "-" "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/536.11 (KHTML, like Gecko) Ubuntu/12.04 Chromium/20.0.1132.47 Chrome/20.0.1132.47 Safari/536.11"</test_message>
						<test_values>
							<test_value name="i0">127.0.0.1</test_value>
							<test_value name="s0">HEAD</test_value>
							<test_value name="s2">/</test_value>
							<test_value name="s3">-</test_value>
							<test_value name="s4">Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/536.11 (KHTML, like Gecko) Ubuntu/12.04 Chromium/20.0.1132.47 Chrome/20.0.1132.47 Safari/536.11</test_value>
							<test_value name="s5">-</test_value>
							<test_value name="i2">200</test_value>
							<test_value name="i3">334</test_value>
						</test_values>
					</example>
					</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="snort" id='8'>
		<pattern>snort</pattern>
		<rules>
			<rule provider="ELSA" class='8' id='8'>
				<patterns>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@] @QSTRING:i1:{}@ @IPv4:i2:@:@NUMBER:i3:@ -> @IPv4:i4:@:@NUMBER:i5:@</pattern>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@] @QSTRING:i1:{}@ @IPv4:i2:@ -> @IPv4:i4:@</pattern>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@]: @QSTRING:i1:{}@ @IPv4:i2:@:@NUMBER:i3:@ -> @IPv4:i4:@:@NUMBER:i5:@</pattern>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@]: @QSTRING:i1:{}@ @IPv4:i2:@ -> @IPv4:i4:@</pattern>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1: {@@ESTRING:i1:}@ @IPv4:i2:@:@NUMBER:i3:@ -> @IPv4:i4:@:@NUMBER:i5:@</pattern>
					<!--<pattern>@QSTRING:s0:[]@@QSTRING:s1: @[Classification:@QSTRING:s2: ]@ [Priority@QSTRING:i0: ]@: @QSTRING:i1:{}@ @IPv4:i2:@:@NUMBER:i3:@ -> @IPv4:i4:@:@NUMBER:i5:@</pattern>-->
				</patterns>
				<example>
					<test_message program="snort">[1:485:5] ICMP Destination Unreachable Communication Administratively Prohibited [Classification: Misc activity] [Priority: 3] {ICMP} 192.168.1.1 -> 10.0.0.0</test_message>
					<test_value name="s0">1:485:5</test_value>
					<test_value name="s1">ICMP Destination Unreachable Communication Administratively Prohibited </test_value>
					<test_value name="s2">Misc activity</test_value>
					<test_value name="i0">3</test_value>
					<test_value name="i1">ICMP</test_value>
					<test_value name="i2">192.168.1.1</test_value>
					<test_value name="i4">10.0.0.0</test_value>
				</example>
			</rule>
			<rule provider="Laurel" class='8' id='8'>
				<!-- Rules for logs with interface included -->
				<patterns>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@] @QSTRING:s3:&lt;&gt;@ @QSTRING:i1:{}@ @IPv4:i2:@:@NUMBER:i3:@ -> @IPv4:i4:@:@NUMBER:i5:@</pattern>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@] @QSTRING:s3:&lt;&gt;@ @QSTRING:i1:{}@ @IPv4:i2:@ -> @IPv4:i4:@</pattern>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@]: @QSTRING:s3:&lt;&gt;@ @QSTRING:i1:{}@ @IPv4:i2:@:@NUMBER:i3:@ -> @IPv4:i4:@:@NUMBER:i5:@</pattern>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@]: @QSTRING:s3:&lt;&gt;@ @QSTRING:i1:{}@ @IPv4:i2:@ -> @IPv4:i4:@</pattern>
					<pattern>@QSTRING:s0:[]@@QSTRING:s1: @[Classification:@QSTRING:s2: ]@ [Priority@QSTRING:i0: ]@: @QSTRING:i1:{}@ @IPv4:i2:@:@NUMBER:i3:@ -> @IPv4:i4:@:@NUMBER:i5:@</pattern>
				</patterns>
				<example>
					<test_message program="snort">[1:2010939:2] ET POLICY Suspicious inbound to PostgreSQL port 5432 [Classification: Potentially Bad Traffic] [Priority: 2]: &lt;eth1&gt; {TCP} 192.168.193.245:38472 -> 192.168.193.1:5432</test_message>
					<test_value name="s0">1:2010939:2</test_value>
					<test_value name="s1">ET POLICY Suspicious inbound to PostgreSQL port 5432 </test_value>
					<test_value name="s2">Potentially Bad Traffic</test_value>
					<test_value name="s3">eth1</test_value>
					<test_value name="i0">2</test_value>
					<test_value name="i1">TCP</test_value>
					<test_value name="i2">192.168.193.245</test_value>
					<test_value name="i3">38472</test_value>
					<test_value name="i4">192.168.193.1</test_value>
					<test_value name="i5">5432</test_value>
				</example>
			</rule>
		</rules>
	</ruleset>
	<!--<ruleset>
		<rules>
			<rule class="10" id="10" context-id="ironport-icid" context-timeout="10" context-scope="program">
				<patterns>
					<pattern>Info: New SMTP ICID @NUMBER:icid:@ interface @ESTRING:interface_name: @(@IPv4:interface_ip:@) address @IPv4:sender_ip:@ reverse dns host @ESTRING:sender_dns: @verified yes</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="ironport_mail_logs">Info: New SMTP ICID 696117306 interface InternalNet (192.168.1.1) address 192.168.1.1 reverse dns host hostname verified yes</test_message>
						<test_value name="icid">696117306</test_value>
						<test_value name="interface_name">InternalNet</test_value>
						<test_value name="interface_ip">192.168.1.1</test_value>
						<test_value name="sender_ip">192.168.1.1</test_value>
						<test_value name="sender_dns">hostname</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>-->
	<ruleset name="ssh">
		<pattern>sshd</pattern>
		<rules>
			<rule class="11" id="11">
				<patterns>
					<!-- s0=usracct.authmethod, s1=usracct.username, s2=usracct.device, i0=port, s3=usracct.service -->
					<pattern>Accepted @ESTRING:s0: @for @ESTRING:s1: @from @ESTRING:s2: @port @ESTRING:i0: @@ANYSTRING:s3@</pattern>
				</patterns>
			</rule>
			<rule class="12" id="12">
				<patterns>
					<!-- s0=usracct.authmethod, s1=usracct.username, s2=usracct.device, i0=port, s3=usracct.service -->
					<pattern>Failed @ESTRING:s0: @for @ESTRING:s1: @from @ESTRING:s2: @port @ESTRING:i0: @@ANYSTRING:s3@</pattern>
					<pattern>Failed @ESTRING:s0: @for invalid user @ESTRING:s1: @from @ESTRING:s2: @port @ESTRING:i0: @@ANYSTRING:s3@</pattern>
					<pattern>Failed @ESTRING:s0: @for illegal user @ESTRING:s1: @from @ESTRING:s2: @port @ESTRING:i0: @@ANYSTRING:s3@</pattern>
				</patterns>
			</rule>
			<rule class="13" id="13">
				<patterns>
					<!-- s0=usracct.username -->
					<pattern>pam_unix(sshd:session): session closed for user @ANYSTRING:s0:@</pattern>
					<pattern>session closed for user @ANYSTRING:s0:@</pattern>
				</patterns>
			</rule>
		</rules>
	</ruleset>
	<ruleset>
		<pattern>bro_dns</pattern>
		<rules>
			<rule class="14" id="14">
				<patterns>
					<pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i4:|@@ESTRING::|@@ESTRING:s0:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ANYSTRING:s1@</pattern>
					<pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i4:|@@ESTRING::|@@ESTRING:s0:|@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="bro_dns">1318443095.831281|0L5Ro2iPit1|10.0.0.0|23657|69.22.154.225|53|udp|31608|e2932.c.akamaiedge.net|1|C_INTERNET|1|A|0|NOERROR|F|T|F|F|F|1|20.000000|23.0.124.9</test_message>
						<!-- srcip -->
						<test_value name="i0">10.0.0.0</test_value>
						<!-- srcport -->
						<test_value name="i1">23657</test_value>
						<!-- dstip -->
						<test_value name="i2">69.22.154.225</test_value>
						<!-- dstport -->
						<test_value name="i3">53</test_value>
						<!-- proto -->
						<test_value name="i4">udp</test_value>
						<!-- hostname -->
						<test_value name="s0">e2932.c.akamaiedge.net</test_value>
						<!-- answer -->
						<test_value name="s1">23.0.124.9</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset>
		<pattern>bro_notice</pattern>
		<rules>
			<rule class="15" id="15">
				<patterns>
					<pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:s0:|@@ESTRING:s1:|@@ANYSTRING::@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="bro_notice">1318443067.534801|tZOKnx1pO1j|10.0.0.0|44780|198.87.182.145|80|HTTP::MD5|10.0.0.0 5074d0c1988df72c1be354f8b842021a http://msft.digitalrivercontent.net/01/108767003-10238044--NOA//office2010/X17-75238.exe|5074d0c1988df72c1be354f8b842021a|10.0.0.0|198.87.182.145|80|-|worker-2|Notice::ACTION_LOG|6|3600.000000|-|-|-|-|-|-|-|-|-</test_message>
						<!-- srcip -->
						<test_value name="i0">10.0.0.0</test_value>
						<!-- srcport -->
						<test_value name="i1">44780</test_value>
						<!-- dstip -->
						<test_value name="i2">198.87.182.145</test_value>
						<!-- dstport -->
						<test_value name="i3">80</test_value>
						<!-- notice_type -->
						<test_value name="s0">HTTP::MD5</test_value>
						<!-- notice_msg -->
						<test_value name="s1">10.0.0.0 5074d0c1988df72c1be354f8b842021a http://msft.digitalrivercontent.net/01/108767003-10238044--NOA//office2010/X17-75238.exe</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset>
		<pattern>bro_smtp</pattern>
		<rules>
			<rule class="16" id="16">
				<patterns>
					<pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING::|@@ESTRING:s0:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:s3:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:s4:|@@ESTRING:s5:|@@ANYSTRING::@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="bro_smtp">1320612601.697404|SFiDYDwOSl8|10.0.0.0|45765|66.94.25.228|25|@woMgeVXDE|server.example.com|&lt;prvs=284e51a33=user@domain.com&gt;|&lt;user@example.com&gt;|Sun, 6 Nov 2011 14:50:00 -0600|"user" &lt;user@domain.com&gt;|"'user@example.com'" &lt;user@example.com&gt;|-|&lt;F3AC33A1A5033546890246040DCA32E303CDF29D5FE6@mailserver.domain.com&gt;|&lt;user@example.com&gt;|RE: some subject|-|from mailserver.domain.com ([10.0.0.0]) with mapi; Sun, 6 Nov 2011 14:50:01 -0600|from mailserver.domain.com ([10.0.0.0]) by mailserver.domain.com with ESMTP/TLS/RC4-MD5; 06 Nov 2011 14:50:01 -0600|250 2.0.0 10wk4g5v6k-1 Message accepted for delivery|192.168.1.1,10.0.0.0|-|F</test_message>
						<!-- srcip -->
						<test_value name="i0">10.0.0.0</test_value>
						<!-- srcport -->
						<test_value name="i1">45765</test_value>
						<!-- dstip -->
						<test_value name="i2">66.94.25.228</test_value>
						<!-- dstport -->
						<test_value name="i3">25</test_value>
						<!-- server -->
						<test_value name="s0">server.example.com</test_value>
						<!-- from -->
						<test_value name="s1">"user" &lt;user@domain.com&gt;</test_value>
						<!-- to -->
						<test_value name="s2">"'user@example.com'" &lt;user@example.com&gt;</test_value>
						<!-- subject -->
						<test_value name="s3">RE: some subject</test_value>
						<!-- last_reply -->
						<test_value name="s4">250 2.0.0 10wk4g5v6k-1 Message accepted for delivery</test_value>
						<!-- path -->
						<test_value name="s5">192.168.1.1,10.0.0.0</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset>
		<pattern>bro_smtp_entities</pattern>
		<rules>
			<rule class="17" id="17">
				<patterns>
					<pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING::|@@ESTRING:s0:|@@ESTRING:i4:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="bro_smtp_entities">1320613389.303478|zQQiHb1x3fj|216.33.127.82|37295|10.0.0.0|25|@VqmVdbY2Mm3|CDocuments and SettingsckaiserLocal SettingsTemporary Internet FilesContent.IE535ZF226Areport[3].pdf|54399|application/pdf|-|-|-</test_message>
						<!-- srcip -->
						<test_value name="i0">216.33.127.82</test_value>
						<!-- srcport -->
						<test_value name="i1">37295</test_value>
						<!-- dstip -->
						<test_value name="i2">10.0.0.0</test_value>
						<!-- dstport -->
						<test_value name="i3">25</test_value>
						<!-- filename -->
						<test_value name="s0">CDocuments and SettingsckaiserLocal SettingsTemporary Internet FilesContent.IE535ZF226Areport[3].pdf</test_value>
						<!-- content_len -->
						<test_value name="i4">54399</test_value>
						<!-- mime_type -->
						<test_value name="s1">application/pdf</test_value>
						<!-- md5 -->
						<test_value name="s2">-</test_value>
						<!-- extraction_file -->
						<test_value name="s3">-</test_value>
						<!-- excerpt -->
						<test_value name="s4">-</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset>
		<pattern>bro_ssl</pattern>
		<rules>
			<rule class="18" id="18">
				<patterns>
					<pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING::|@@ESTRING::|@@ESTRING:s0:|@@ESTRING::|@@ESTRING:s1:|@@ESTRING::|@@ESTRING:i4:|@@ANYSTRING::@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="bro_ssl">1319824864.447838|g6XHk1uplZc|10.0.0.0|19427|80.175.58.76|443|TLSv10|TLS_RSA_WITH_RC4_128_MD5|-|48eacd8fda1a4f48188288ce09ba84d93b8b40aaafdeafd8bace5a1ba9f7c3ce|CN=www.forneymaterialstesting.com,OU=Comodo InstantSSL,OU=Online Sales,O=Forney Inc,streetAddress=One Adams Place,L=Seven Fields\,,ST=Pennsylvania,postalCode=16046,C=US|1286341200.000000|1381035599.000000|04918ecb442ca62e6e8f29272b9cff42|ok</test_message>
						<!-- srcip -->
						<test_value name="i0">10.0.0.0</test_value>
						<!-- srcport -->
						<test_value name="i1">19427</test_value>
						<!-- dstip -->
						<test_value name="i2">80.175.58.76</test_value>
						<!-- dstport -->
						<test_value name="i3">443</test_value>
						<!-- hostname -->
						<test_value name="s0">-</test_value>
						<!-- subject -->
						<test_value name="s1">CN=www.forneymaterialstesting.com,OU=Comodo InstantSSL,OU=Online Sales,O=Forney Inc,streetAddress=One Adams Place,L=Seven Fields\,,ST=Pennsylvania,postalCode=16046,C=US</test_value>
						<!-- expiration -->
						<test_value name="i4">1381035599.000000</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset>
		<pattern>bro_http</pattern>
		<rules>
			<rule class="19" id="19">
				<patterns>
					<!--ts      uid     id.orig_h       id.orig_p       id.resp_h       id.resp_p       trans_depth     method  
					  host    uri     referrer        user_agent      request_body_len        response_body_len       status_code     
					  status_msg      info_code       info_msg        filename        tags    username        password        
					  proxied mime_type       md5     extraction_file-->
					<pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@NUMBER::@|@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING:i4:|@@ESTRING::|@@ESTRING:i5:|@</pattern>
					<!--ts      uid     id.orig_h       id.orig_p       id.resp_h       id.resp_p       method  
					host    uri     referrer        user_agent      request_body_len       
					 request_body_interrupted        response_body_len       response_body_interrupted       status_code     
					 status_msg      filename        tags    username        password        proxied mime_type
       md5     extraction_file-->
					<pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING::|@@ESTRING::|@@ESTRING:i5:|@@ESTRING:i4:|@@ESTRING::|@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="bro_http">1319824864.447838|g6XHk1uplZc|10.0.0.0|19427|80.175.58.76|80|GET|www.google.com|/|http://example.com|myagent|200|0|1000|...</test_message>
						<!-- srcip -->
						<test_value name="i0">10.0.0.0</test_value>
						<!-- srcport -->
						<test_value name="i1">19427</test_value>
						<!-- dstip -->
						<test_value name="i2">80.175.58.76</test_value>
						<!-- dstport -->
						<test_value name="i3">80</test_value>
						<!-- method -->
						<test_value name="s0">GET</test_value>
						<!-- host -->
						<test_value name="s1">www.google.com</test_value>
						<!-- uri -->
						<test_value name="s2">/</test_value>
						<!-- referer -->
						<test_value name="s3">http://example.com</test_value>
						<!-- user_agent -->
						<test_value name="s4">myagent</test_value>
						<!-- status_code -->
						<test_value name="i4">200</test_value>
						<!-- content_length -->
						<test_value name="i5">1000</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset>
		<pattern>bro_conn</pattern>
		<rules>
			<rule class="20" id="20">
				<patterns>
					<!--ts	uid	id.orig_h	id.orig_p	id.resp_h	id.resp_p	proto	service	duration	orig_bytes	resp_bytes	
					conn_state	local_orig	missed_bytes	history	orig_pkts	orig_ip_bytes	resp_pkts	resp_ip_bytes-->
					<pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i4:|@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="bro_conn">1319824864.447838|g6XHk1uplZc|10.0.0.0|19427|80.175.58.76|80|tcp|...</test_message>
						<!-- srcip -->
						<test_value name="i0">10.0.0.0</test_value>
						<!-- srcport -->
						<test_value name="i1">19427</test_value>
						<!-- dstip -->
						<test_value name="i2">80.175.58.76</test_value>
						<!-- dstport -->
						<test_value name="i3">80</test_value>
						<!-- proto -->
						<test_value name="i4">tcp</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="fortinet_url" id='21'>
		<pattern>kernel</pattern>
		<rules>
			<rule provider="ELSA" class='21' id='21'>
				<patterns>
					<pattern>date=@ESTRING:: @time=@ESTRING:: @devname=@ESTRING:: @device_id=@ESTRING:: @log_id=@ESTRING:: @subtype=@ESTRING:: @type=webfilter pri=@ESTRING:: @vd=@ESTRING:: @policyid=@ESTRING:: @identidx=@ESTRING:: @serial=@ESTRING:: @user=@ESTRING:s0: @group=@ESTRING:s1: @src=@IPv4:i0:@ sport=@ESTRING:i1: @src_port=@ESTRING:: @src_int=@ESTRING:: @dst=@IPv4:i2:@ dport=@ESTRING:i3: @dst_port=@ESTRING:: @dst_int=@ESTRING:: @service=@ESTRING:s2: @hostname=@ESTRING:s3: @profiletype=@ESTRING:: @profile=@ESTRING:: @status=@ESTRING:s4: @req_type=@ESTRING:: @url=@ESTRING:s5: @method=@ESTRING:: @class=@ESTRING:: @cat=@ESTRING:i4: @cat_desc=@QSTRING::""@ carrier_ep=@ESTRING:: @msg=@QSTRING::""@ class_desc=@ESTRING:: @profilegroup=</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="kernel">date=2012-02-10 time=11:27:01 devname=CUSTID01-SITEID-FW device_id=FG100C999999999 log_id=13312 subtype=ftgd_allow type=webfilter pri=notice vd=VDOM policyid=44 identidx=1 serial=369298248 user=USER group=AD/GROUP src=10.1.2.3 sport=2163 src_port=2163 src_int=INT dst=4.3.2.1 dport=80 dst_port=80 dst_int=WAN service=http hostname=col.stb.s-msn.com profiletype=Webfilter_Profile profile=PROFILE status=passthrough req_type=referral url=/i/79/65F987C952BDA0E84AE52464ADD59.jpg method=domain class=0 cat=41 cat_desc="Search Engines and Portals" carrier_ep=N/A msg="URL belongs to an allowed category in policy" class_desc=N/A profilegroup=N/A</test_message>
						<test_values>
							<test_value name="i0">10.1.2.3</test_value>
							<test_value name="i1">2163</test_value>
							<test_value name="i2">4.3.2.1</test_value>
							<test_value name="i3">80</test_value>
							<test_value name="s0">USER</test_value>
							<test_value name="s1">AD/GROUP</test_value>
							<test_value name="s2">http</test_value>
							<test_value name="s3">col.stb.s-msn.com</test_value>
							<test_value name="s4">passthrough</test_value>
							<test_value name="s5">/i/79/65F987C952BDA0E84AE52464ADD59.jpg</test_value>
							<test_value name="i4">41</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="fortinet_traffic" id='22'>
		<pattern>kernel</pattern>
		<rules>
			<rule provider="ELSA" class='22' id='22'>
				<patterns>
					<pattern>date=@ESTRING:: @time=@ESTRING:: @devname=@ESTRING:: @device_id=@ESTRING:: @log_id=@ESTRING:: @subtype=@ESTRING:: @type=traffic pri=@ESTRING:: @vd=@ESTRING:: @dir_disp=@ESTRING:: @tran_disp=@ESTRING:: @src=@IPv4:i0:@ srcname=@ESTRING:: @src_port=@NUMBER:i1:@ dst=@IPv4:i2:@ dstname=@ESTRING:: @dst_port=@NUMBER:i3:@ tran_ip=@ESTRING:: @tran_port=@ESTRING:: @service=@ESTRING:: @proto=@NUMBER:i4@ app_type=@ESTRING:: @duration=@NUMBER:i5@ rule=@ESTRING:: @policyid=@ESTRING:: @identidx=@ESTRING:: @sent=@ESTRING:: @rcvd=@ESTRING:: @shaper_drop_sent=@ESTRING:: @shaper_drop_rcvd=@ESTRING:: @perip_drop=@ESTRING:: @sent_pkt=@ESTRING:: @rcvd_pkt=@ESTRING:: @src_int=@ESTRING:: @dst_int=@ESTRING:: @SN=@ESTRING:: @app=@ESTRING:: @app_cat=@ESTRING:: @carrier_ep=@ESTRING:: @vpn=@ESTRING:: @status=@ESTRING:: @user=@ESTRING:: @group=@ESTRING:: @shaper_sent_name=@ESTRING:: @shaper_rcvd_name=@ESTRING:: @perip_name</pattern>
					<pattern>date=@ESTRING:: @time=@ESTRING:: @devname=@ESTRING:: @devid=@ESTRING:: @logid=@ESTRING:: @type=traffic subtype=@ESTRING:: @level=@ESTRING:: @vd=@ESTRING:: @srcip=@IPv4:i0:@ srcport=@NUMBER:i1:@ srcintf=@QSTRING::""@ dstip=@IPv4:i2:@ dstport=@NUMBER:i3:@ dstintf=@QSTRING::""@ sessionid=@ESTRING:: @status=@ESTRING:: @policyid=@ESTRING:: @dstcountry=@QSTRING::""@ srccountry=@QSTRING::""@ trandisp=@ESTRING:: @tranip=@ESTRING:: @tranport=@ESTRING:: @service=@ESTRING:: @proto=@NUMBER:i4:@ duration=@NUMBER:i5:@ sentbyte=@ESTRING:: @rcvdbyte=@ESTRING:: @sentpkt=@ESTRING:: @rcvdpkt</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="kernel">date=2012-02-10 time=11:27:01 devname=CUSTID01-SITEID-FW device_id=FGT80C9999999999 log_id=2 subtype=allowed type=traffic pri=notice vd=VDOM dir_disp=org tran_disp=snat src=10.1.2.3 srcname=10.1.2.3 src_port=53624 dst=4.3.2.2 dstname=4.3.2.2 dst_port=80 tran_ip=5.4.3.2 tran_port=49648 service=80/tcp proto=6 app_type=N/A duration=120 rule=49 policyid=49 identidx=0 sent=1221 rcvd=2062 shaper_drop_sent=0 shaper_drop_rcvd=0 perip_drop=0 sent_pkt=7 rcvd_pkt=6 src_int=INT dst_int=WAN SN=16349534 app=N/A app_cat=N/A carrier_ep=N/A vpn=N/A status=accept user=N/A group=N/A shaper_sent_name=N/A shaper_rcvd_name=N/A perip_name=N/A</test_message>
						<test_values>
							<test_value name="i0">10.1.2.3</test_value>
							<test_value name="i1">53624</test_value>
							<test_value name="i2">4.3.2.2</test_value>
							<test_value name="i3">80</test_value>
							<test_value name="i4">6</test_value>
							<test_value name="i5">120</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="checkpoint_deny" id='23'>
		<rules>
			<rule provider="ELSA" class='23' id='23'>
				<patterns>
					<pattern>@QSTRING:i0:""@ @QSTRING::""@ @QSTRING::""@ @QSTRING:s0:""@ @QSTRING:s1:""@ @QSTRING:s2:""@ @QSTRING:s3:""@ @QSTRING:s4:""@ @QSTRING::""@ @QSTRING:i1:""@ @QSTRING:i2:""@ @QSTRING:i3:""@ @QSTRING::""@ @QSTRING::""@ @QSTRING::""@ @QSTRING::""@ "message_info: @ESTRING:s5:"@ @QSTRING::""@ @QSTRING::""@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="">"1" "12Feb2012" "23:59:04" "bond0.30" "FW-INT-CHCKPNT1" "Log" "Drop" "ntp-udp" "ntp-udp" "192.168.1.210" "10.133.3.10" "udp" "" "" "" "" "message_info: Address spoofing" "VPN-1 Power/UTM" "" ""</test_message>
						<test_values>
							<test_value name="i0">1</test_value>
							<test_value name="s0">bond0.30</test_value>
							<test_value name="s1">FW-INT-CHCKPNT1</test_value>
							<test_value name="s2">Log</test_value>
							<test_value name="s3">Drop</test_value>
							<test_value name="s4">ntp-udp</test_value>
							<test_value name="i1">192.168.1.210</test_value>
							<test_value name="i2">10.133.3.10</test_value>
							<test_value name="i3">udp</test_value>
							<test_value name="s5">Address spoofing</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="palo_alto_url" id='24'>
		<rules>
			<rule provider="ELSA" class='24' id='24'>
				<patterns>
					<pattern>@NUMBER::@:@NUMBER::@,@NUMBER::@,@ESTRING::,@url,@NUMBER::@,@ESTRING::,@@IPv4:i0:@,@IPv4:i1:@,@IPv4::@,@IPv4::@,@ESTRING:s0:,@@ESTRING:s1:,@@ESTRING::,@@ESTRING:s2:,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:i2:,@1@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@"@ESTRING:s3:/@@ESTRING:s4:"@,(@NUMBER::@),@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s5:,@</pattern>
					<!-- Alternative pattern for PAN with columns listed -->
					<pattern>@ESTRING::,@ TYPE: THREAT, SUBTYPE: url, THREAT_ID: (@NUMBER::@), ACTION: @ESTRING::,@ RULE: @ESTRING::,@ MISC: "@ESTRING:s3:/@@ESTRING:s4:"@</pattern>
					<values>
						<value name="s4">/$s4</value>
					</values>
				</patterns>
				<examples>
					<example>
						<test_message program="">46:31,002501000259,THREAT,url,0,2012/02/21 09:46:31,192.168.1.1,208.71.123.129,0.0.0.0,0.0.0.0,USERS-Network-AllowAll-to-EXT,domain\joeschmo,,web-browsing,vsys1,Users,External,ethernet1/3,ethernet1/5,forward-syslog-to-elsa,2012/02/2109:46:30,156730,1,50836,80,0,0,0x8000,tcp,alert,"network.realmedia.com/RealMedia/ads/adstream_sx.ads/newsinc_ap_video_us/preroll/vast/sx/ss/a/@x75",(9999),All,informational,client-to-server,19630699,0x0,United States,United States,0,text/xml</test_message>
						<test_values>
							<test_value name="i0">192.168.1.1</test_value>
							<test_value name="i1">208.71.123.129</test_value>
							<test_value name="s0">USERS-Network-AllowAll-to-EXT</test_value>
							<test_value name="s1">domain\joeschmo</test_value>
							<test_value name="s2">web-browsing</test_value>
							<test_value name="i2">156730</test_value>
							<test_value name="s3">network.realmedia.com</test_value>
							<test_value name="s4">/RealMedia/ads/adstream_sx.ads/newsinc_ap_video_us/preroll/vast/sx/ss/a/@x75</test_value>
							<test_value name="s5">United States</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="palo_alto_traffic" id='25'>
		<rules>
			<rule provider="ELSA" class='25' id='25'>
				<patterns>
					<pattern>@NUMBER::@:@NUMBER::@,@ESTRING::TRAFFIC,@@ESTRING:s5:,@@NUMBER::@,@ESTRING::,@@IPv4:i0:@,@IPv4:i1:@,@IPv4::@,@IPv4::@,@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s0:,@@ESTRING:s1:,@@ESTRING:s2:,@@ESTRING:s3:,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:i2:,@@ESTRING:i3:,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:i4:,@@ESTRING::,@@ESTRING:i5:,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s4:,@</pattern>
					<!-- Alternative pattern for PAN with columns listed -->
					<pattern>@ESTRING::,@ TYPE: TRAFFIC, SUBTYPE: @ESTRING:s5:,@ RULE: @ESTRING::,@ ACTION: @ESTRING::,@ INBOUND_INTERFACE: @ESTRING:s2:,@ FROM_ZONE: @ESTRING:s0:,@ SOURCE_USER: @ESTRING::,@ SOURCE_IP: @ESTRING:i0:,@ NAT_SOURCE_IP: @ESTRING::,@ SOURCE_PORT: @ESTRING:i2:,@ OUTBOUND_INTERFACE: @ESTRING:s3:,@ TO_ZONE: @ESTRING:s1:,@ DESTINATION_USER: @ESTRING::,@ DESTINATION_IP: @ESTRING:i1:,@ DESTINATION_PORT: @ESTRING:i3:,@ DESTINATION_LOCATION: @ESTRING:s4:,@ CATEGORY: @ESTRING:s5:,@ PROTOCOL: @ESTRING:i4:,@ APPLICATION: @ESTRING::,@ ELAPSED_TIME: @ESTRING::,@ BYTES: @ESTRING:i5:,@ BYTES_RECEIVED: @ESTRING::,@ BYTES_SENT: @ESTRING::,@ TOTAL_PACKETS: @ESTRING::,@ PACKETS_RECEIVED: @ESTRING::,@ PACKETS_SENT: @ESTRING::,@ REPEAT_COUNT_5sec: </pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="">46:31,002501000259,TRAFFIC,end,0,2012/02/21 09:46:31,10.10.10.10,192.168.1.1,0.0.0.0,0.0.0.0,ALL-http-https-to-BASTION,,,web-browsing,vsys1,External,Bastion,ethernet1/5,ethernet1/2,forward-syslog-to-elsa,2012/02/21 09:46:30,632179,1,4074,80,0,0,0x0,tcp,allow,2986,1493,1493,19,2012/02/21 09:45:57,31,not-resolved,0,453403179,0x0,United States,United States,0,10,9</test_message>
						<test_values>
							<test_value name="i0">10.10.10.10</test_value>
							<test_value name="i1">192.168.1.1</test_value>
							<test_value name="s0">External</test_value>
							<test_value name="s1">Bastion</test_value>
							<test_value name="s2">ethernet1/5</test_value>
							<test_value name="s3">ethernet1/2</test_value>
							<test_value name="i2">4074</test_value>
							<test_value name="i3">80</test_value>
							<test_value name="i4">tcp</test_value>
							<test_value name="i5">2986</test_value>
							<test_value name="s4">United States</test_value>
							<test_value name="s5">end</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="ossec" id='26'>
		<rules>
			<rule provider="ELSA" class='4' id='26'>
				<patterns>
					<pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4:pdb_extracted_sourceip:@->WinEvtLog WinEvtLog: @ESTRING:pdb_extracted_program::@ AUDIT_@ESTRING::(@@ESTRING:i0:)@</pattern>
					<values>
						<value name="PROGRAM">$pdb_extracted_program</value>
					</values>
				</patterns>
				<examples>
					<example>
						<test_message program="">2012 Feb 20 09:04:41 (serverb) 123.123.40.23->WinEvtLog WinEvtLog: Security: AUDIT_SUCCESS(4769): Microsoft-Windows-Security-Auditing: bgreen@DOM1.A.COM: DOM1.A.COM: serverb.dom1.a.com: A Kerberos service ticket was requested. Account Information:  Account Name: bgreen@DOM1.A.COM  Account Domain:  DOM1.A.COM  Logon GUID: {CBB22EBF-4367-CB43-E5AC-2A8C13FD9641}  Service Information:  Service Name:  SERVERC$  Service ID: S-1-5-21-117536760-2556423787-3220343774-160533  Network Information:Client Address:  ::ffff:123.123.39.33  Client Port:  62513  Additional Information:  Ticket Options:  0x40810000  Ticket Encryption Type: 0x12  Failure Code:  0x0  Transited Services: -  This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested.</test_message>
						<test_values>
							<test_value name="i0">4769</test_value>
							<test_value name="PROGRAM">Security</test_value>
							<test_value name="pdb_extracted_sourceip">123.123.40.23</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="barracuda" id='27'>
		<pattern>from</pattern>
		<rules>
			<rule provider="ELSA" class='27' id='27'>
				<patterns>
					<pattern>@IPv4:pdb_extracted_sourceip:@: scan[@NUMBER::@]@ESTRING::[@@IPv4:i0:@] @ESTRING:: @@ESTRING:: @@ESTRING:: @SCAN @ESTRING:: @@ESTRING:s0: @@ESTRING:s1: @@ESTRING:: @@ESTRING:i1: @@ESTRING:i2: @@ESTRING:s2: @SZ:@NUMBER::@ SUBJ:@ANYSTRING:s3:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="from">192.168.1.10: scan[8077]: UNKNOWN[10.37.80.102] 1329946623-01792678721d5b70001-uwIQq5 1329946623 1329946623 SCAN - sender@example.com recipient@example.com 0.341 0 0 - SZ:1634 SUBJ:Service - Flow Capture (inside)|status.example.com|PROBLEM</test_message>
						<test_values>
							<test_value name="i0">10.37.80.102</test_value>
							<test_value name="s0">sender@example.com</test_value>
							<test_value name="s1">recipient@example.com</test_value>
							<test_value name="i1">0</test_value>
							<test_value name="i2">0</test_value>
							<test_value name="s2">-</test_value>
							<test_value name="s3">Service - Flow Capture (inside)|status.example.com|PROBLEM</test_value>
							<test_value name="pdb_extracted_sourceip">192.168.1.10</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
			<rule provider="ELSA" class='28' id='28'>
				<patterns>
					<pattern>@IPv4:pdb_extracted_sourceip:@: inbound/pass@NUMBER::@[@NUMBER::@]@ESTRING::[@@IPv4:i0:@] @ESTRING:: @@ESTRING:: @@ESTRING:: @RECV @ESTRING:s0: @@ESTRING:s1: @@ESTRING:i1: @@ESTRING:i2: @@ANYSTRING:s2:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="from">192.168.1.10: inbound/pass1[22443]: host.com[8.7.24.13] 1329330589-01792657ab486050001-5NcMI6 1329330589 1329330590 RECV test@test.com test1@test.ca 2 62 8.7.24.13</test_message>
						<test_values>
							<test_value name="i0">8.7.24.13</test_value>
							<test_value name="s0">test@test.com</test_value>
							<test_value name="s1">test1@test.ca</test_value>
							<test_value name="i1">2</test_value>
							<test_value name="i2">62</test_value>
							<test_value name="s2">8.7.24.13</test_value>
							<test_value name="pdb_extracted_sourceip">192.168.1.10</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
			<rule provider="ELSA" class='29' id='29'>
				<patterns>
					<pattern>@IPv4:pdb_extracted_sourceip:@: outbound/smtp[@NUMBER::@]: @IPv4:i0:@ @ESTRING:: @@ESTRING:: @@ESTRING:: @SEND @ESTRING:: @@ESTRING:i1: @@ESTRING:: @@ESTRING:: @@ESTRING:: @@ANYSTRING:s0:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="from">192.168.1.10: outbound/smtp[17580]: 127.0.0.1 1329330593-01792657ab486060001-slQ29D 0 0 SEND - 1 40FD5C6C659 250 &lt;0be658c5d60e4a0ea51a0a4745d6115e@mail.ca&gt; Queued mail for delivery</test_message>
						<test_values>
							<test_value name="i0">127.0.0.1</test_value>
							<test_value name="s0">Queued mail for delivery</test_value>
							<test_value name="i1">1</test_value>
							<test_value name="pdb_extracted_sourceip">192.168.1.10</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="barracuda_scan" id='27_scan'>
		<pattern>scan</pattern>
		<rules>
			<rule provider="ELSA" class='27' id='27'>
				<patterns>
					<pattern>@ESTRING::[@@IPv4:i0:@] @ESTRING:: @@ESTRING:: @@ESTRING:: @SCAN @ESTRING:: @@ESTRING:s0: @@ESTRING:s1: @@ESTRING:: @@ESTRING:i1: @@ESTRING:i2: @@ESTRING:s2: @SZ:@NUMBER::@ SUBJ:@ANYSTRING:s3:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="scan">UNKNOWN[10.37.80.102] 1329946623-01792678721d5b70001-uwIQq5 1329946623 1329946623 SCAN - sender@example.com recipient@example.com 0.341 0 0 - SZ:1634 SUBJ:Service - Flow Capture (inside)|status.example.com|PROBLEM</test_message>
						<test_values>
							<test_value name="i0">10.37.80.102</test_value>
							<test_value name="s0">sender@example.com</test_value>
							<test_value name="s1">recipient@example.com</test_value>
							<test_value name="i1">0</test_value>
							<test_value name="i2">0</test_value>
							<test_value name="s2">-</test_value>
							<test_value name="s3">Service - Flow Capture (inside)|status.example.com|PROBLEM</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>		
	<ruleset name="barracuda_inbound" id='27_inbound'>
		<pattern>inbound</pattern>
		<rules>
			<rule provider="ELSA" class='28' id='28'>
				<patterns>
					<pattern>@ESTRING::[@@IPv4:i0:@] @ESTRING:: @@ESTRING:: @@ESTRING:: @RECV @ESTRING:s0: @@ESTRING:s1: @@ESTRING:i1: @@ESTRING:i2: @@ANYSTRING:s2:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="inbound/pass1">host.com[8.7.24.13] 1329330589-01792657ab486050001-5NcMI6 1329330589 1329330590 RECV test@test.com test1@test.ca 2 62 8.7.24.13</test_message>
						<test_values>
							<test_value name="i0">8.7.24.13</test_value>
							<test_value name="s0">test@test.com</test_value>
							<test_value name="s1">test1@test.ca</test_value>
							<test_value name="i1">2</test_value>
							<test_value name="i2">62</test_value>
							<test_value name="s2">8.7.24.13</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>		
	<ruleset name="barracuda_outbound" id='27_outbound'>
		<pattern>outbound</pattern>
		<rules>
			<rule provider="ELSA" class='29' id='29'>
				<patterns>
					<pattern>@IPv4:i0:@ @ESTRING:: @@ESTRING:: @@ESTRING:: @SEND @ESTRING:: @@ESTRING:i1: @@ESTRING:: @@ESTRING:: @@ESTRING:: @@ANYSTRING:s0:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="outbound/smtp">192.168.1.10: outbound/smtp[17580]: 127.0.0.1 1329330593-01792657ab486060001-slQ29D 0 0 SEND - 1 40FD5C6C659 250 &lt;0be658c5d60e4a0ea51a0a4745d6115e@mail.ca&gt; Queued mail for delivery</test_message>
						<test_values>
							<test_value name="i0">127.0.0.1</test_value>
							<test_value name="s0">Queued mail for delivery</test_value>
							<test_value name="i1">1</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='Microsoft Exchange via Epilog' id='30'>
		<patterns>exchmtlog</patterns>
		<rules>
			<rule provider='ELSA' class='30' id='30'>
				<patterns>
					<pattern>@ESTRING::,@@ESTRING::,@@ESTRING:s0:,@@ESTRING::,@@ESTRING:s1:,@@ESTRING::,@@ESTRING::,@STOREDRIVER,DELIVER,@NUMBER::@,@ESTRING:s2:,@@ESTRING:s3:,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s4:,@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="exchmtlog">2012-03-16T17:13:16.475Z,,servername,,casservername,,,STOREDRIVER,DELIVER,23065261,sender@some.org,recipient@other.org,,156558,1,,,TEST MESSAGE SUBJECT,sender@some.org,sender@some.org,2012-03-16T17:13:16.147Z</test_message>
						<test_value name="s0">servername</test_value>
						<test_value name="s1">casservername</test_value>
						<test_value name="s2">sender@some.org</test_value>
						<test_value name="s3">recipient@other.org</test_value>
						<test_value name="s4">TEST MESSAGE SUBJECT</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='URL via Novell forwarder script' id='31'>
		<patterns>novell_logs_</patterns>
		<rules>
			<rule provider='ELSA' class='7' id='7'>
				<patterns>
					<!-- date time c-ip cs-username s-ip s-sitename cs-method cs-uri cs-uri-stem cs-uri-query c-version sc-status x-cache-info sc-header-size sc(Content-Length) sc-completed sc-bytes
	 cs-bytes time-taken cs(User-Agent) cs(Cookie) cs(Referer) cs(X-Forwarded-For) cached x-fill-proxy-ip x-origin-ip rs-bytes sc(ETag) cs(If-Range) cs(Range) sc(Content-Range) cs(Pragma
	) sc(Pragma)-->
					<pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:username:|@@ESTRING:i1:|@@ESTRING:s1:|@@ESTRING:s0:|@@ESTRING::|@"@ESTRING:s2:"@|"@ESTRING::|@@ESTRING::|@@ESTRING:i2:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:i3:|@@ESTRING:i5:|@"@ESTRING:s4:"@|@ESTRING::|@"@ESTRING:s3:"@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="novell_logs_test">2012-04-06|15:57:49|10.124.19.11|-|10.0.59.189|dev.mail.example.com|GET|"https://dev.mail.example.com:443/owa/auth/preload.htm"|"/owa/auth/preload.htm"|""|HTTP/1.1|200|"In Cache, Fresh"|550|"1527"|Success|2077|916|0.000|"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; .NET CLR 1.1.4322; InfoPath.3)"|"ASPSESSIONIDSSDSDRTA=JPNHAEECMAIOIDMIHNPJGOKE; ASPSESSIONIDSQDSCQSA=FGPFCJECCJAGBFBHLPHPKMPD"|"https://dev.mail.example.com/exchweb/bin/auth/owalogon.asp?url=https://dev.mail.example.com/exchange&amp;reason=0&amp;replaceCurrent=1"|""|1|-|-|""|""|""|""|""|""</test_message>
						<test_value name="i0">10.124.19.11</test_value>
						<test_value name="i1">10.0.59.189</test_value>
						<test_value name="s0">GET</test_value>
						<test_value name="s1">dev.mail.example.com</test_value>
						<test_value name="s2">/owa/auth/preload.htm</test_value>
						<test_value name="s3">https://dev.mail.example.com/exchweb/bin/auth/owalogon.asp?url=https://dev.mail.example.com/exchange&amp;reason=0&amp;replaceCurrent=1</test_value>
						<test_value name="s4">Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; .NET CLR 1.1.4322; InfoPath.3)</test_value>
						<test_value name="i2">200</test_value>
						<test_value name="i3">916</test_value>
						<test_value name="i5">0.000</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="Windows Event log Firewall Filtering" id='32'>
		<pattern>Security-Auditing</pattern>
		<rules>
			<rule provider="M Smith" class='3' id='1000'>
				<patterns>
					<pattern>@ESTRING:: @The Windows Filtering Platform has @ESTRING:: @a connection. Application Information: Process ID: @ESTRING:: @Application Name: @ESTRING:: @Network Information: Direction: @ESTRING:: @Source Address: @IPv4:i1@ Source Port: @NUMBER:i2:@ Destination Address: @IPv4:i3:@ Destination Port: @NUMBER:i4:@ Protocol: @NUMBER:i0:@ Filter Information: Filter Run-Time ID: @ESTRING:: @Layer Name: @ESTRING:: @Layer Run-Time ID: @NUMBER::@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="Security-Auditing">5156: The Windows Filtering Platform has permitted a connection. Application Information: Process ID: 1924 Application Name: \device\harddiskvolume1\users\admin\appdata\local\dude\win.exe Network Information: Direction: Outbound Source Address: 1.1.1.1 Source Port: 1234 Destination Address: 2.2.2.2 Destination Port: 4567 Protocol: 17 Filter Information: Filter Run-Time ID: 70078 Layer Name: Connect Layer Run-Time ID: 48</test_message>
							<!-- srcip -->
							<test_value name="i1">1.1.1.1</test_value>
							<!-- srcport -->
							<test_value name="i2">1234</test_value>
							<!-- dstip -->
							<test_value name="i3">2.2.2.2</test_value>
							<!-- dstport -->
							<test_value name="i4">4567</test_value>
							<!-- proto -->
							<test_value name="i0">17</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="TMG-Gateway-W3C-Logs-via-Epilog" id='10099'>
            <rules>
                    <rule provider="bgreen" class='3' id='10099'>
                            <patterns>
                                    <pattern>@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:::@@ESTRING:i2:|@@ESTRING:i3::@@ESTRING:i4:|@@ESTRING:i1:|@@ESTRING:s0:|@@ESTRING:s1:|@</pattern>
                            </patterns>
                            <examples>
                                    <example>
                                            <test_message program="ISAFWSLOG">BOB|2012-07-05|15:05:11|TCP|123.123.123.222:40521|123.123.123.111:443|123.123.111.111|Local Host|Internal|Establish|0x0|-|HTTPS|0|0|0|0|-|-|-|-|4|1874698|-|-|::|-|1048575|-</test_message>
                                            <!-- proto -->
                                            <test_value name="i0">TCP</test_value>
                                            <!-- srcip -->
                                            <test_value name="i1">123.123.111.111</test_value>
                                            <!-- srcport -->
                                            <test_value name="i2">40521</test_value>
                                            <!-- dstip -->
                                            <test_value name="i3">123.123.123.111</test_value>
                                            <!-- dstport -->
                                            <test_value name="i4">443</test_value>
											<!-- inside interface -->
											<test_value name="s0">Local Host</test_value>
											<!-- outside interface -->
											<test_value name="s1">Internal</test_value>
                                    </example>
                            </examples>
                    </rule>
            </rules>
    </ruleset>
    <ruleset name="ISAFWSLog-via-Epilog">
    		<patterns>
    			<pattern>ISAFWSLog</pattern>
    		</patterns>
            <rules>
                    <rule provider="ELSA" class='7' id='7'>
                            <patterns>
                                    <pattern>@ESTRING:i0:|@@ESTRING::|@@ESTRING:s4:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:i1:|@@ESTRING::|@@ESTRING::|@@ESTRING:s0:|@@ESTRING:://@@ESTRING:s1:/@@ESTRING:s2:|@@ESTRING:i2:|@</pattern>
                                    <pattern>@ESTRING:i0:|@@ESTRING::|@@ESTRING:s4:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:i1:|@@ESTRING::|@@ESTRING:s0:|@@ESTRING::|@@ESTRING:s1:|@</pattern>
                            </patterns>
                            <examples>
                                    <example>
                                    		<test_message program="ISAFWSLog">1.1.1.1|domainname\username|Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.2)|2012-08-27|18:59:49|MAD00GS6|2.2.2.2|2.2.2.2|80|http|GET|http://search.twitter.com/search.json?q=hp%2520dell%2520problems&amp;since_id=240160211699122180&amp;callback=twitter._queue_callback&amp;result_type=mixed|200|Internet Access to Users|Req ID: 1f449904 |Internal|External|0x480|Allowed|-</test_message>
                                            <test_value name="i0">1.1.1.1</test_value>
											<test_value name="i1">2.2.2.2</test_value>
											<test_value name="s0">GET</test_value>
											<test_value name="s1">search.twitter.com</test_value>
											<test_value name="s2">search.json?q=hp%2520dell%2520problems&amp;since_id=240160211699122180&amp;callback=twitter._queue_callback&amp;result_type=mixed</test_value>
											<test_value name="s3"></test_value>
											<test_value name="s4">Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.2)</test_value>
											<test_value name="s5"></test_value>
											<test_value name="i2">200</test_value>
											<test_value name="i3"></test_value>
											<test_value name="i4"></test_value>
                                    </example>
                            </examples>
                    </rule>
            </rules>
    </ruleset>
    <ruleset name="Cisco SEC">
    	<pattern>%SEC-</pattern>
    	<rules>
    		<rule provider="ELSA" class="2" id="2">
    			<pattern>list @ESTRING:s0: @denied @ESTRING:i0: @@ESTRING:i1:(@@NUMBER:i2:@) -> @ESTRING:i3:(@@NUMBER:i4:@@ANYSTRING@</pattern>
    			<examples>
	    			<example>
	    				<test_message program="%SEC-6-IPACCESSLOGP">list FILTER-INTERNET-IN denied tcp 1.2.3.4(53420) -> 5.6.7.8(23), 1 packet</test_message>
	    				<test_value name="s2">FILTER-INTERNET-IN</test_value>
	    				<test_value name="i0">tcp</test_value>
	    				<test_value name="i1">1.2.3.4</test_value>
	    				<test_value name="i2">53420</test_value>
	    				<test_value name="i3">5.6.7.8</test_value>
	    				<test_value name="i4">23</test_value>
	    			</example>
	    		</examples>
	    	</rule>
    	</rules>
    	<rules>
    		<rule provider="ELSA" class="3" id="3">
    			<pattern>list @ESTRING:s0: @permitted @ESTRING:i0: @@ESTRING:i1:(@@NUMBER:i2:@) -> @ESTRING:i3:(@@NUMBER:i4:@@ANYSTRING@</pattern>
    			<examples>
	    			<example>
	    				<test_message program="%SEC-6-IPACCESSLOGP">list FILTER-INTERNET-IN permitted tcp 1.2.3.4(53420) -> 5.6.7.8(23), 1 packet</test_message>
	    				<test_value name="s2">FILTER-INTERNET-IN</test_value>
	    				<test_value name="i0">tcp</test_value>
	    				<test_value name="i1">1.2.3.4</test_value>
	    				<test_value name="i2">53420</test_value>
	    				<test_value name="i3">5.6.7.8</test_value>
	    				<test_value name="i4">23</test_value>
	    			</example>
	    		</examples>
	    	</rule>
    	</rules>
    </ruleset>
    <!--<ruleset name="CEF">
    	<rules>
    		<rule provider="ELSA" class="32" id="32">
    			<pattern>CEF:@NUMBER::@|@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@NUMBER:i0:@|@ANYSTRING:s5:@</pattern>
    			<examples>
	    			<example>
	    				<test_message program="">CEF:0|security|threatmanager|1.0|100|worm successfully stopped|10|src=10.0.0.1 dst=2.1.2.2 spt=1232</test_message>
	    				<test_value name="i0">10</test_value>
	    				<test_value name="s0">security</test_value>
	    				<test_value name="s1">threatmanager</test_value>
	    				<test_value name="s2">1.0</test_value>
	    				<test_value name="s3">100</test_value>
	    				<test_value name="s4">worm successfully stopped</test_value>
	    				<test_value name="s5">src=10.0.0.1 dst=2.1.2.2 spt=1232</test_value>
	    			</example>
	    		</examples>
	    	</rule>
    	</rules>
	</ruleset>-->
	<ruleset name="Watchguard Firewall">
		<pattern>firewall</pattern>
		<rules>
			<rule provider="ELSA" class="2" id="2">
				<pattern>Deny @ESTRING:s0: @@ESTRING:s1: @@NUMBER::@ @ESTRING:i0: @@NUMBER::@ @NUMBER::@ @ESTRING:i1: @@ESTRING:i3: @@ESTRING:i2: @@ESTRING:i4: @</pattern>
				<examples>
					<example>
						<test_message program="firewall">Deny 0-External Firebox 1340 tcp 20 56 74.125.225.143 10.0.1.1 443 3449 offset 5 A 451109382 win 257 (Unhandled External Packet-00)</test_message>
						<test_value name="i0">tcp</test_value>
						<test_value name="i1">74.125.225.143</test_value>
						<test_value name="i2">443</test_value>
						<test_value name="i3">10.0.1.1</test_value>
						<test_value name="i4">3449</test_value>
						<test_value name="s0">0-External</test_value>
						<test_value name="s1">Firebox</test_value>
					</example>
				</examples>
			</rule>
			<rule provider="ELSA" class="3" id="3">
				<pattern>Allow @ESTRING:s1: @@ESTRING:s0: @@NUMBER::@ @ESTRING:i0: @@NUMBER::@ @NUMBER::@ @ESTRING:i1: @@ESTRING:i3: @@ESTRING:i2: @@ESTRING:i4: @</pattern>
				<examples>
					<example>
						<test_message program="firewall">Allow 1-Trusted 0-External 52 tcp 20 127 192.168.1.31 96.60.118.121 55185 8005 offset 8 S 1125590318 win 32 (ATSBDR-00)</test_message>
						<test_value name="i0">tcp</test_value>
						<test_value name="i1">192.168.1.31</test_value>
						<test_value name="i2">55185</test_value>
						<test_value name="i3">96.60.118.121</test_value>
						<test_value name="i4">8005</test_value>
						<test_value name="s0">0-External</test_value>
						<test_value name="s1">1-Trusted</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="Watchguard URL">
		<pattern>http-proxy</pattern>
		<rules>
			<rule provider="ELSA" class="7" id="7">
				<pattern>Deny @ESTRING:: @@ESTRING:: @tcp @ESTRING:i0: @@ESTRING:i1: @@NUMBER::@ @NUMBER::@ msg="@ESTRING::"@ proxy_act="@ESTRING::"@ op="@ESTRING:s0:"@ dstname="@ESTRING:s1:"@ arg="@ESTRING:s2:"@ sent_bytes="@NUMBER::@" rcvd_bytes="@NUMBER:i3:@</pattern>
				<examples>
					<example>
						<test_message program="http-proxy">Deny 1-Trusted 0-External tcp 192.168.1.17 23.21.13.155 62115 80 msg="HTTP Request" proxy_act="HTTP-Client.1" op="" dstname="23.21.13.155" arg="" sent_bytes="1" rcvd_bytes="0" (HTTP-proxy-ExceptLunch-00)</test_message>
						<test_value name="i0">192.168.1.17</test_value>
						<test_value name="i1">23.21.13.155</test_value>
						<test_value name="i3">0</test_value>
						<test_value name="s0"></test_value>
						<test_value name="s1">23.21.13.155</test_value>
						<test_value name="s2"></test_value>
					</example>
				</examples>
			</rule>
			<rule provider="ELSA" class="7" id="7">
				<pattern>Allow @ESTRING:: @@ESTRING:: @tcp @ESTRING:i0: @@ESTRING:i1: @@NUMBER::@ @NUMBER::@ msg="@ESTRING::"@ proxy_act="@ESTRING::"@ op="@ESTRING:s0:"@ dstname="@ESTRING:s1:"@ arg="@ESTRING:s2:"@ sent_bytes="@NUMBER::@" rcvd_bytes="@NUMBER:i3:@</pattern>
				<examples>
					<example>
						<test_message program="http-proxy">Allow 1-Trusted 0-External tcp 192.168.1.22 74.125.142.95 2597 80 msg="HTTP Request" proxy_act="HTTP-Client.1" op="GET" dstname="ajax.googleapis.com" arg="/ajax/libs/jquery/1.5/jquery.min.js" sent_bytes="363" rcvd_bytes="30368" (HTTP-proxy-ExceptLunch-00)</test_message>
						<test_value name="i0">192.168.1.22</test_value>
						<test_value name="i1">74.125.142.95</test_value>
						<test_value name="i3">30368</test_value>
						<test_value name="s0">GET</test_value>
						<test_value name="s1">ajax.googleapis.com</test_value>
						<test_value name="s2">/ajax/libs/jquery/1.5/jquery.min.js</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="Sidewinder Firewall">
		<pattern>auditd</pattern>
		<rules>
			<rule provider="ELSA" class="2" id="2">
				<pattern>date@ESTRING::event=@ACL deny@ESTRING::srcip=@@IPv4:i1:@,srcport=@NUMBER:i2:@,srcburb=@ESTRING:s1:,@dstip=@IPv4:i3:@,dstport=@NUMBER:i4:@,dstburb=@ESTRING:s0:,@protocol=@NUMBER:i0:@</pattern>
				<pattern>date@ESTRING::event=@ACL deny@ESTRING::srcip=@@IPv4:i1:@,srcburb=@ESTRING:s1:,@dstip=@IPv4:i3:@,dstburb=@ESTRING:s0:,@protocol=@NUMBER:i0:@</pattern>
				<pattern>date@ESTRING::type=@t_attack@ESTRING::srcip=@@IPv4:i1:@,srcport=@NUMBER:i2:@,srcburb=@ESTRING:s1:,@@ESTRING::protocol=@@NUMBER:i0:@@ESTRING::dstip=@@IPv4:i3:@,dstport=@NUMBER:i4:@,dstburb=@ESTRING:s0:,@</pattern>
				<pattern>date@ESTRING::type=@t_netprobe@ESTRING::srcip=@@IPv4:i1:@,srcport=@NUMBER:i2:@,srcburb=@ESTRING:s1:,@dstip=@IPv4:i3:@,dstport=@NUMBER:i4:@,protocol=@NUMBER:i0:@,interface=@ESTRING:s0:,@</pattern>
				<examples>
					<example>
						<test_message program="auditd">date="Oct 1 16:24:57 2012 UTC",fac=f_kernel_ipfilter,area=a_general_area,type=t_ipftraffic,pri=p_major,pid=0,ruid=0,euid=0,pgid=0,logid=0,cmd=kernel,domain=htpp,edomain=htpp,hostname=localhost,event=IP Filter session open,rule_name=myrule-out,srcip=1.1.1.1,srcport=1,srcburb=internal2,dstip=2.2.2.2,dstport=2,dstburb=external1,protocol=6,netsessid=5069c3d9000c7831</test_message>
						<test_value name="i0">6</test_value>
						<test_value name="i1">1.1.1.1</test_value>
						<test_value name="i2">1</test_value>
						<test_value name="i3">2.2.2.2</test_value>
						<test_value name="i4">2</test_value>
						<test_value name="s0">external1</test_value>
						<test_value name="s1">internal2</test_value>
					</example>
				</examples>
			</rule>
			<rule provider="ELSA" class="3" id="3">
				<pattern>date@ESTRING::event=@proxy traffic end@ESTRING::srcip=@@IPv4:i1:@,srcport=@NUMBER:i2:@,srcburb=@ESTRING:s1:,@protocol=@NUMBER:i0:@,dstip=@IPv4:i3:@,dstport=@NUMBER:i4:@,dstburb=@ESTRING:s0:,@bytes_written_to_client=@NUMBER:i5:@</pattern>
				<pattern>date@ESTRING::event=@proxy traffic end@ESTRING::srcip=@@IPv4:i1:@,srcburb=@ESTRING:s1:,@protocol=@NUMBER:i0:@,dstip=@IPv4:i3:@,dstburb=@ESTRING:s0:,@bytes_written_to_client=@NUMBER:i5:@</pattern>
				<pattern>date@ESTRING::event=@IP Filter session close@ESTRING::srcip=@@IPv4:i1:@,srcport=@NUMBER:i2:@,srcburb=@ESTRING:s1:,@dstip=@IPv4:i3:@,dstport=@NUMBER:i4:@,dstburb=@ESTRING:s0:,@bytes_written_to_client=@NUMBER:i5:@@ESTRING::protocol=@@NUMBER:i0:@</pattern>
				<pattern>date@ESTRING::event=@IP Filter session timeout@ESTRING::srcip=@@IPv4:i1:@,srcport=@NUMBER:i2:@,srcburb=@ESTRING:s1:,@dstip=@IPv4:i3:@,dstport=@NUMBER:i4:@,dstburb=@ESTRING:s0:,@bytes_written_to_client=@NUMBER:i5:@@ESTRING::protocol=@@NUMBER:i0:@</pattern>
				<examples>
					<example>
						<test_message program="auditd">date="Oct 1 16:24:57 2012 UTC",fac=f_http_proxy,area=a_libproxycommon,type=t_nettraffic,pri=p_major,pid=28529,ruid=0,euid=0,pgid=28529,logid=0,cmd=httpp,domain=htpp,edomain=htpp,hostname=localhost,event=proxy traffic end,service_name=http,netsessid=5069c3d9000ab8ce,srcip=1.1.1.1,srcport=1,srcburb=internal2,protocol=6,dstip=2.2.2.2,dstport=2,dstburb=external1,bytes_written_to_client=1297,bytes_written_to_server=421,rule_name=www.isa.webproxy,cache_hit=0,request_status=0,start_time="Mon Oct 1 11:24:57 2012"</test_message>
						<test_value name="i0">6</test_value>
						<test_value name="i1">1.1.1.1</test_value>
						<test_value name="i2">1</test_value>
						<test_value name="i3">2.2.2.2</test_value>
						<test_value name="i4">2</test_value>
						<test_value name="s0">external1</test_value>
						<test_value name="s1">internal2</test_value>
						<test_value name="i5">1297</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="Websense">
		<program></program>
		<rules>
			<rule provider="ELSA" class="33" id="33">
				<pattern>vendor=Websense@ESTRING::action=@@ESTRING:s5: @severity=@ESTRING::category=@@ESTRING:s3: @user=@ESTRING:s0: @src_host=@IPv4:i0:@@ESTRING::dst_host=@@ESTRING:s1: @dst_ip=@IPv4:i1:@@ESTRING::http_response=@@NUMBER:i2:@@ESTRING::http_user_agent=@@ESTRING:s4: @@ESTRING::disposition=@@ESTRING:s3: @@ESTRING:://@@ESTRING::/@@ANYSTRING:s2:@</pattern>
				<pattern>vendor=Websense@ESTRING::action=@@ESTRING:s5: @severity=@ESTRING::category=@@ESTRING:s3: @user=@ESTRING:s0: @src_host=@IPv4:i0:@@ESTRING::dst_host=@@ESTRING:s1: @dst_ip=@IPv4:i1:@@ESTRING::http_response=@@NUMBER:i2:@@ESTRING::http_user_agent=@@ESTRING:s4: @@ESTRING::disposition=@@ESTRING:s3: @</pattern>
				<values>
					<value name="s2">/$s2</value>
				</values>
				<examples>
					<example>
						<test_message program="">vendor=Websense product=Security product_version=7.7.0 action=permitted severity=1 category=153 user=- src_host=10.64.134.74 src_port=62189 dst_host=mail.google.com dst_ip=74.125.224.53 dst_port=443 bytes_out=197 bytes_in=76 http_response=200 http_method=CONNECT http_content_type=- http_user_agent=Mozilla/5.0_(Windows;_U;_Windows_NT_6.1;_en-US;_rv:1.9.2.23)_Gecko/20110920_Firefox/3.6.23 http_proxy_status_code=200 reason=- disposition=1034 policy=- role=8 duration=0 url=https://mail.google.com/index.html</test_message>
						<test_value name="i0">10.64.134.74</test_value>
						<test_value name="i1">74.125.224.53</test_value>
						<test_value name="i2">200</test_value>
						<test_value name="s0">-</test_value>
						<test_value name="s1">mail.google.com</test_value>
						<test_value name="s2">/index.html</test_value>
						<test_value name="s3">1034</test_value>
						<test_value name="s4">Mozilla/5.0_(Windows;_U;_Windows_NT_6.1;_en-US;_rv:1.9.2.23)_Gecko/20110920_Firefox/3.6.23</test_value>
						<test_value name="s5">permitted</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="McAfee SmartFilter">
		<program></program>
		<rules>
			<rule provider="ELSA" class="33" id="33">
				<pattern>@IPv4:i0@ - @ESTRING:s0: @@ESTRING::"@@ESTRING:://@@ESTRING:s1:/@@ESTRING:s2:"@ @NUMBER:i2:@ @ESTRING:s5: @@QSTRING:s3:"@</pattern>
				<values>
					<value name="s2">/$s2</value>
				</values>
				<examples>
					<example>
						<test_message program="">1.1.1.1 - username  [03/Oct/2012:06:52:51 +0100]  "GET http://a.nice.url/some/uri?parameters=go&amp;in=here" 200 ALLOW "Blogs/Wiki, Entertainment"</test_message>
						<test_value name="i0">1.1.1.1</test_value>
						<test_value name="i2">200</test_value>
						<test_value name="s0">username</test_value>
						<test_value name="s1">a.nice.url</test_value>
						<test_value name="s2">/some/uri?parameters=go&amp;in=here</test_value>
						<test_value name="s3">Blogs/Wiki, Entertainment</test_value>
						<test_value name="s5">ALLOW</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="Netflow" id='Netflow'>
		<pattern>netflow_syslog</pattern>
		<rules>
			<rule provider="ELSA" class='34' id='34'>
				<patterns>
					<pattern>@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i4:|@@ESTRING:i5:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ANYSTRING:s5:@</pattern>
					<pattern>@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i4:|@@ESTRING:i5:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@</pattern>
					<pattern>@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i4:|@@ESTRING:i5:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="netflow_syslog">tcp|192.85.128.47|35843|1.1.1.1|443|30486|2173|US|Palo Alto, CA|37.376202|-122.182602|HPES - Hewlett-Packard Company</test_message>
						<test_values>
							<test_value name="i0">tcp</test_value>
							<test_value name="i1">192.85.128.47</test_value>
							<test_value name="i2">35843</test_value>
							<test_value name="i3">1.1.1.1</test_value>
							<test_value name="i4">443</test_value>
							<test_value name="i5">30486</test_value>
							<test_value name="s0">2173</test_value>
							<test_value name="s1">US</test_value>
							<test_value name="s2">Palo Alto, CA</test_value>
							<test_value name="s3">37.376202</test_value>
							<test_value name="s4">-122.182602</test_value>
							<test_value name="s5">HPES - Hewlett-Packard Company</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="BIND">
		<pattern>BIND</pattern>
		<rules>
			<rule provider="ELSA" class='35' id='35'>
				<patterns>
					<pattern>@ESTRING::client @@ESTRING:i0:#@@NUMBER::@: query: @ESTRING:s0: @IN @ESTRING:s1: @@ESTRING:: @(@ESTRING:s2:)@</pattern>
					<pattern>@ESTRING::client @@ESTRING:i0:#@@NUMBER::@ (@ESTRING::)@: query: @ESTRING:s0: @IN @ESTRING:s1: @@ESTRING:: @(@ESTRING:s2:)@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program="BIND-DNS">02-Nov-2012 15:49:58.516 queries: info: client 198.211.94.24#55557: query: 174.2.219.178.in-addr.arpa IN PTR + (198.211.94.23)</test_message>
						<test_values>
							<test_value name="i0">198.211.94.24</test_value>
							<test_value name="s0">174.2.219.178.in-addr.arpa</test_value>
							<test_value name="s1">PTR</test_value>
							<test_value name="s2">198.211.94.23</test_value>
						</test_values>
					</example>
					<example>
						<test_message program="BIND-DNS">02-Nov-2012 16:01:27.731 client 10.10.10.185#49999 (10.10.10.185): query: p.twitter.com IN A + (10.10.210.210)</test_message>
						<test_values>
							<test_value name="i0">10.10.10.185</test_value>
							<test_value name="s0">p.twitter.com</test_value>
							<test_value name="s1">A</test_value>
							<test_value name="s2">10.10.210.210</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name="IISWebLog">
		<pattern>IISWebLog</pattern>
		<rule provider="ELSA" class="7" id="IIS_7">
			<pattern>@ESTRING:: @@ESTRING:: @@ESTRING:: @@ESTRING:: @@IPv4:i1:@ @ESTRING:s0: @@ESTRING:s2: @@ESTRING:: @@ESTRING:: @@ESTRING:: @@IPv4:i0:@ @ESTRING:: @@ESTRING:s4: @@ESTRING:: @@ESTRING:s3: @@ESTRING:s1: @@NUMBER:i2:@ @NUMBER::@ @NUMBER::@ @NUMBER:i3:@ @NUMBER::@ @NUMBER:i5:@</pattern>
			<examples>
				<example>
					<test_message program="IISWebLog">2012-12-13 13:39:16 W3SVC1 MYSERVERNAME 1.1.1.1 GET / - 80 - 2.2.2.2 HTTP/1.1 Mozilla/5.0+(Windows+NT+6.1;+WOW64)+AppleWebKit/537.11+(KHTML,+like+Gecko)+Chrome/23.0.1271.95+Safari/537.11 - - www.fqdn.of.website.from.host.header.com 301 0 0 401 408 453</test_message>
					<test_values>
						<test_value name="i0">2.2.2.2</test_value>
						<test_value name="i1">1.1.1.1</test_value>
						<test_value name="i2">301</test_value>
						<test_value name="i3">401</test_value>
						<test_value name="i5">453</test_value>
						<test_value name="s0">GET</test_value>
						<test_value name="s1">www.fqdn.of.website.from.host.header.com</test_value>
						<test_value name="s2">/</test_value>
						<test_value name="s3">-</test_value>
						<test_value name="s4">Mozilla/5.0+(Windows+NT+6.1;+WOW64)+AppleWebKit/537.11+(KHTML,+like+Gecko)+Chrome/23.0.1271.95+Safari/537.11</test_value>
					</test_values>
				</example>
			</examples>
		</rule>
	</ruleset>		
</patterndb>
